(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const A of s.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&r(A)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const J=console.log,U=t=>{throw new Error(t)},X=t=>new Promise(e=>setTimeout(e,t)),$=(t,e)=>{t.font="36px monospace",t.fillStyle="red",t.fillText(e,50,50)},ee=`struct VSOut {
    @builtin(position) pos: vec4f,
    // @location(0) color: vec3f,
    @location(0) uv: vec2f,
};

struct UBO {
  mvp: mat4x4<f32>,
  primaryColor: vec4f,
  accentColor: vec4f
};

@group(0) @binding(0)
var<uniform> uniforms: UBO;

@vertex
fn main(
    @location(0) in_pos: vec2f,
    @location(1) in_color: vec3f,
    @location(2) in_uv: vec2f,
) -> VSOut {
    var vs_out: VSOut;

    vs_out.pos = uniforms.mvp * vec4f(in_pos, 0.0, 1.0);
    // vs_out.color = in_color;
    vs_out.uv = in_uv;

    return vs_out;
}
`,te=`@group(1) @binding(1)
var texSampler: sampler;

@group(1) @binding(2)
var tex: texture_2d<f32>;

struct UBO {
  mvp: mat4x4<f32>,
  primaryColor: vec4f,
  accentColor: vec4f
};

@group(0) @binding(0)
var<uniform> uniforms: UBO;

@fragment
fn main(
    // @location(0) frag_color: vec3f,
    @location(0) uv: vec2f
) -> @location(0) vec4f {
    var texColor = textureSample(tex, texSampler, uv) * 255;

    let outputColor = mix(
        uniforms.primaryColor,
        uniforms.accentColor,
        texColor.r
    );

    // return vec4f(texColor * 200, 1.0);
    // return vec4f(texColor.rrg, 1.0);
    return vec4f(outputColor.rgb, 1.0);
}
`,ne="/chip8-wasm/assets/chip8_wasm_bg-214a2669.wasm",re=async(t={},e)=>{let n;if(e.startsWith("data:")){const r=e.replace(/^data:.*?base64,/,"");let o;if(typeof Buffer=="function"&&typeof Buffer.from=="function")o=Buffer.from(r,"base64");else if(typeof atob=="function"){const s=atob(r);o=new Uint8Array(s.length);for(let A=0;A<s.length;A++)o[A]=s.charCodeAt(A)}else throw new Error("Cannot decode base64-encoded data URL");n=await WebAssembly.instantiate(o,t)}else{const r=await fetch(e),o=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&o.startsWith("application/wasm"))n=await WebAssembly.instantiateStreaming(r,t);else{const s=await r.arrayBuffer();n=await WebAssembly.instantiate(s,t)}}return n.instance.exports};let i;function oe(t){i=t}const f=new Array(128).fill(void 0);f.push(void 0,null,!0,!1);function a(t){return f[t]}let m=f.length;function ae(t){t<132||(f[t]=m,m=t)}function P(t){const e=a(t);return ae(t),e}const ce=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let W=new ce("utf-8",{ignoreBOM:!0,fatal:!0});W.decode();let h=null;function F(){return(h===null||h.byteLength===0)&&(h=new Uint8Array(i.memory.buffer)),h}function E(t,e){return t=t>>>0,W.decode(F().subarray(t,t+e))}function c(t){m===f.length&&f.push(f.length+1);const e=m;return m=f[e],f[e]=t,e}let O=0;function ie(t,e){const n=e(t.length*1,1)>>>0;return F().set(t,n/1),O=t.length,n}function g(t,e){try{return t.apply(this,e)}catch(n){i.__wbindgen_exn_store(c(n))}}class l{static __wrap(e){e=e>>>0;const n=Object.create(l.prototype);return n.__wbg_ptr=e,n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();i.__wbg_chip_free(e)}static new(){const e=i.chip_new();return l.__wrap(e)}static vram_width(){return i.chip_vram_width()>>>0}static vram_height(){return i.chip_vram_height()>>>0}vram_ptr(){return i.chip_vram_ptr(this.__wbg_ptr)}load(e){const n=ie(e,i.__wbindgen_malloc),r=O;i.chip_load(this.__wbg_ptr,n,r)}next(){return i.chip_next(this.__wbg_ptr)!==0}tick(){const e=i.chip_tick(this.__wbg_ptr);return S.__wrap(e)}set_key(e){i.chip_set_key(this.__wbg_ptr,e)}unset_key(e){i.chip_unset_key(this.__wbg_ptr,e)}}class S{static __wrap(e){e=e>>>0;const n=Object.create(S.prototype);return n.__wbg_ptr=e,n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();i.__wbg_outputchange_free(e)}get vram(){return i.__wbg_get_outputchange_vram(this.__wbg_ptr)!==0}set vram(e){i.__wbg_set_outputchange_vram(this.__wbg_ptr,e)}get beep(){return i.__wbg_get_outputchange_beep(this.__wbg_ptr)!==0}set beep(e){i.__wbg_set_outputchange_beep(this.__wbg_ptr,e)}}function se(t){P(t)}function _e(t){const e=a(t).crypto;return c(e)}function ue(t){const e=a(t);return typeof e=="object"&&e!==null}function Ae(t){const e=a(t).process;return c(e)}function de(t){const e=a(t).versions;return c(e)}function fe(t){const e=a(t).node;return c(e)}function ge(t){return typeof a(t)=="string"}function le(){return g(function(){const t=module.require;return c(t)},arguments)}function pe(t,e){const n=E(t,e);return c(n)}function we(t){const e=a(t).msCrypto;return c(e)}function me(){return g(function(t,e){a(t).getRandomValues(a(e))},arguments)}function be(){return g(function(t,e){a(t).randomFillSync(P(e))},arguments)}function he(t){return typeof a(t)=="function"}function ye(t,e){const n=new Function(E(t,e));return c(n)}function ve(){return g(function(t,e){const n=a(t).call(a(e));return c(n)},arguments)}function xe(){return g(function(){const t=self.self;return c(t)},arguments)}function Ue(){return g(function(){const t=window.window;return c(t)},arguments)}function Be(){return g(function(){const t=globalThis.globalThis;return c(t)},arguments)}function Ee(){return g(function(){const t=global.global;return c(t)},arguments)}function Se(t){return a(t)===void 0}function ke(){return g(function(t,e,n){const r=a(t).call(a(e),a(n));return c(r)},arguments)}function Ce(t){const e=a(t).buffer;return c(e)}function Re(t,e,n){const r=new Uint8Array(a(t),e>>>0,n>>>0);return c(r)}function Ge(t){const e=new Uint8Array(a(t));return c(e)}function Qe(t,e,n){a(t).set(a(e),n>>>0)}function Te(t){const e=new Uint8Array(t>>>0);return c(e)}function Ie(t,e,n){const r=a(t).subarray(e>>>0,n>>>0);return c(r)}function De(t){const e=a(t);return c(e)}function Me(t,e){throw new Error(E(t,e))}function Le(){const t=i.memory;return c(t)}URL=globalThis.URL;const _=await re({"./chip8_wasm_bg.js":{__wbindgen_object_drop_ref:se,__wbg_crypto_c48a774b022d20ac:_e,__wbindgen_is_object:ue,__wbg_process_298734cf255a885d:Ae,__wbg_versions_e2e78e134e3e5d01:de,__wbg_node_1cd7a5d853dbea79:fe,__wbindgen_is_string:ge,__wbg_require_8f08ceecec0f4fee:le,__wbindgen_string_new:pe,__wbg_msCrypto_bcb970640f50a1e8:we,__wbg_getRandomValues_37fa2ca9e4e07fab:me,__wbg_randomFillSync_dc1e9a60c158336d:be,__wbindgen_is_function:he,__wbg_newnoargs_581967eacc0e2604:ye,__wbg_call_cb65541d95d71282:ve,__wbg_self_1ff1d729e9aae938:xe,__wbg_window_5f4faef6c12b79ec:Ue,__wbg_globalThis_1d39714405582d3c:Be,__wbg_global_651f05c6a0944d1c:Ee,__wbindgen_is_undefined:Se,__wbg_call_01734de55d61e11d:ke,__wbg_buffer_085ec1f694018c4f:Ce,__wbg_newwithbyteoffsetandlength_6da8e527659b86aa:Re,__wbg_new_8125e318e6245eed:Ge,__wbg_set_5cf90238115182c3:Qe,__wbg_newwithlength_e5d69174d6984cd7:Te,__wbg_subarray_13db269f57aa838d:Ie,__wbindgen_object_clone_ref:De,__wbindgen_throw:Me,__wbindgen_memory:Le}},ne),V=_.memory,Pe=_.__wbg_chip_free,We=_.__wbg_outputchange_free,Fe=_.__wbg_get_outputchange_vram,Oe=_.__wbg_set_outputchange_vram,Ve=_.__wbg_get_outputchange_beep,Ke=_.__wbg_set_outputchange_beep,Ze=_.chip_new,Ne=_.chip_vram_ptr,qe=_.chip_load,je=_.chip_next,Ye=_.chip_tick,ze=_.chip_set_key,He=_.chip_unset_key,Je=_.chip_vram_width,Xe=_.chip_vram_height,$e=_.__wbindgen_malloc,et=_.__wbindgen_exn_store,tt=Object.freeze(Object.defineProperty({__proto__:null,__wbg_chip_free:Pe,__wbg_get_outputchange_beep:Ve,__wbg_get_outputchange_vram:Fe,__wbg_outputchange_free:We,__wbg_set_outputchange_beep:Ke,__wbg_set_outputchange_vram:Oe,__wbindgen_exn_store:et,__wbindgen_malloc:$e,chip_load:qe,chip_new:Ze,chip_next:je,chip_set_key:ze,chip_tick:Ye,chip_unset_key:He,chip_vram_height:Xe,chip_vram_ptr:Ne,chip_vram_width:Je,memory:V},Symbol.toStringTag,{value:"Module"}));oe(tt);const nt=new Float32Array([-.99,.99,0,0,-.99,-.99,0,1,.99,-.99,1,1,.99,.99,1,0]),rt={attributes:[{shaderLocation:0,offset:0,format:"float32x2"},{shaderLocation:2,offset:4*2,format:"float32x2"}],arrayStride:4*4,stepMode:"vertex"},ot=new Float32Array([1,0,0,0,1,0,0,0,1,1,1,0]),at={attributes:[{shaderLocation:1,offset:0,format:"float32x3"}],arrayStride:4*3,stepMode:"vertex"},ct=new Uint16Array([0,1,2,0,2,3]),it=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,.19,.19,.19,1,.87,.87,.87,1]),k=new Map([["IBM Logo","roms/loktar00/IBM Logo.ch8"],["Brix","roms/loktar00/Brix [Andreas Gustafsson, 1990].ch8"],["Particles","roms/loktar00/Particle Demo [zeroZshadow, 2008].ch8"],["Zero","roms/loktar00/Zero Demo [zeroZshadow, 2007].ch8"],["Keypad","roms/loktar00/Keypad Test [Hap, 2006].ch8"],["Maze","roms/loktar00/Maze [David Winter, 199x].ch8"],["Trip8","roms/loktar00/Trip8 Demo (2008) [Revival Studios].ch8"],["Chip8 Pic","roms/loktar00/Chip8 Picture.ch8"],["Heart Beat","roms/mattmikolay/heartmonitor/heart_monitor.ch8"],["Morse Code","roms/mattmikolay/morsecode/morse_demo.ch8"],["Random","roms/mattmikolay/randomnumber/random_number_test.ch8"],["WipeOff","roms/aquova/WIPEOFF"],["Test Image","roms/aquova/TEST_IMG"]]),y=new Map([["1",[1,0]],["2",[2,1]],["3",[3,2]],["4",[12,3]],["q",[4,4]],["w",[5,5]],["e",[6,6]],["r",[13,7]],["a",[7,8]],["s",[8,9]],["d",[9,10]],["f",[14,11]],["z",[10,12]],["x",[0,13]],["c",[11,14]],["v",[15,15]]]),st=new Audio("data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU="),u=document.querySelector("#chip-display");{const e=window.devicePixelRatio??1;u.width=u.clientWidth*e,u.height=u.clientWidth/2*e,J(`canvas: ${u.width} x ${u.height}`)}const _t=await fetch(k.get("Chip8 Pic")),ut=await _t.arrayBuffer(),At=new Uint8Array(ut),w=l.new();w.load(At);const M=document.querySelectorAll("#key-og span.key"),L=document.querySelectorAll("#key-map span.key");function dt(t){document.addEventListener("keydown",e=>{if(y.has(e.key)){const[n,r]=y.get(e.key);t.set_key(n),M[r].style.filter="invert(90%)",L[r].style.filter="invert(90%)"}}),document.addEventListener("keyup",e=>{if(y.has(e.key)){const[n,r]=y.get(e.key);t.unset_key(n),M[r].style.filter="none",L[r].style.filter="none"}})}dt(w);const B=document.querySelector("#roms");B.addEventListener("change",async t=>{const e=k.get(B.value),n=await(await fetch(e)).arrayBuffer(),r=new Uint8Array(n);w.load(r)});for(let[t,e]of k){const n=document.createElement("option");n.value=t,n.textContent=t,B.appendChild(n)}try{let t=function(b,I){const p=n.createBuffer({size:b.byteLength+3&-4,usage:I,mappedAtCreation:!0});return(b instanceof Float32Array?new Float32Array(p.getMappedRange()):new Uint16Array(p.getMappedRange())).set(b),p.unmap(),p};const e=navigator.gpu??U("WebGPU is not supported"),n=await(await e.requestAdapter())?.requestDevice()??U("No device found"),r=e.getPreferredCanvasFormat(),o=u.getContext("webgpu")??U("No webgpu context for the canvas");o.configure({device:n,format:r,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:"opaque"});const s=n.createTexture({size:[u.width,u.height,1],dimension:"2d",format:"depth24plus-stencil8",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),A=t(nt,GPUBufferUsage.VERTEX),K=t(ot,GPUBufferUsage.VERTEX),Z=t(ct,GPUBufferUsage.INDEX),N=t(it,GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST),C=n.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{}}]}),q=n.createBindGroup({layout:C,entries:[{binding:0,resource:{buffer:N}}]}),[v,R]=[l.vram_width(),l.vram_height()],j=new Uint8Array(V.buffer,w.vram_ptr(),v*R),G=n.createTexture({size:{width:l.vram_width(),height:l.vram_height(),depthOrArrayLayers:1},format:"r8unorm",usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING}),Y=n.createSampler({addressModeU:"repeat",addressModeV:"repeat",magFilter:"nearest",minFilter:"nearest"}),Q=n.createBindGroupLayout({entries:[{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}]}),z=n.createBindGroup({layout:Q,entries:[{binding:1,resource:Y},{binding:2,resource:G.createView()}]}),H=n.createRenderPipeline({layout:n.createPipelineLayout({bindGroupLayouts:[C,Q]}),vertex:{module:n.createShaderModule({code:ee}),entryPoint:"main",buffers:[rt,at]},fragment:{module:n.createShaderModule({code:te}),entryPoint:"main",targets:[{format:r}]},primitive:{cullMode:"none",frontFace:"cw",topology:"triangle-list"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus-stencil8"}});async function T(b){for(;w.next();){const D=w.tick();if(D.beep&&st.play(),D.vram)break;await X(.05)}n.queue.writeTexture({texture:G},j,{offset:0,bytesPerRow:v},{width:v,height:R});const p={view:o.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"},x=n.createCommandEncoder(),d=x.beginRenderPass({colorAttachments:[p],depthStencilAttachment:{view:s.createView(),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store",stencilClearValue:0,stencilLoadOp:"clear",stencilStoreOp:"store"}});d.setPipeline(H),d.setViewport(0,0,u.width,u.height,0,1),d.setScissorRect(0,0,u.width,u.height),d.setBindGroup(0,q),d.setBindGroup(1,z),d.setVertexBuffer(0,A),d.setVertexBuffer(1,K),d.setIndexBuffer(Z,"uint16"),d.drawIndexed(6),d.end(),n.queue.submit([x.finish()]),requestAnimationFrame(T)}requestAnimationFrame(T)}catch(t){const e=u.getContext("2d");$(e,`${t}`)}
