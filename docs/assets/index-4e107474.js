(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const g of i.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&o(g)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();const K=console.log,p=t=>{throw new Error(t)},N=t=>new Promise(e=>setTimeout(e,t)),V=`struct VSOut {
    @builtin(position) pos: vec4f,
    // @location(0) color: vec3f,
    @location(0) uv: vec2f,
};

struct UBO {
  mvp: mat4x4<f32>,
  primaryColor: vec4f,
  accentColor: vec4f
};

@group(0) @binding(0)
var<uniform> uniforms: UBO;

@vertex
fn main(
    @location(0) in_pos: vec2f,
    @location(1) in_color: vec3f,
    @location(2) in_uv: vec2f,
) -> VSOut {
    var vs_out: VSOut;

    vs_out.pos = uniforms.mvp * vec4f(in_pos, 0.0, 1.0);
    // vs_out.color = in_color;
    vs_out.uv = in_uv;

    return vs_out;
}
`,Z=`@group(1) @binding(1)
var texSampler: sampler;

@group(1) @binding(2)
var tex: texture_2d<f32>;

struct UBO {
  mvp: mat4x4<f32>,
  primaryColor: vec4f,
  accentColor: vec4f
};

@group(0) @binding(0)
var<uniform> uniforms: UBO;

@fragment
fn main(
    // @location(0) frag_color: vec3f,
    @location(0) uv: vec2f
) -> @location(0) vec4f {
    var texColor = textureSample(tex, texSampler, uv) * 255;

    let outputColor = mix(
        uniforms.primaryColor,
        uniforms.accentColor,
        texColor.r
    );

    // return vec4f(texColor * 200, 1.0);
    // return vec4f(texColor.rrg, 1.0);
    return vec4f(outputColor.rgb, 1.0);
}
`,q="/chip8-wasm/assets/chip8_wasm_bg-214a2669.wasm",j=async(t={},e)=>{let n;if(e.startsWith("data:")){const o=e.replace(/^data:.*?base64,/,"");let r;if(typeof Buffer=="function"&&typeof Buffer.from=="function")r=Buffer.from(o,"base64");else if(typeof atob=="function"){const i=atob(o);r=new Uint8Array(i.length);for(let g=0;g<i.length;g++)r[g]=i.charCodeAt(g)}else throw new Error("Cannot decode base64-encoded data URL");n=await WebAssembly.instantiate(r,t)}else{const o=await fetch(e),r=o.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&r.startsWith("application/wasm"))n=await WebAssembly.instantiateStreaming(o,t);else{const i=await o.arrayBuffer();n=await WebAssembly.instantiate(i,t)}}return n.instance.exports};let s;function Y(t){s=t}const d=new Array(128).fill(void 0);d.push(void 0,null,!0,!1);function a(t){return d[t]}let m=d.length;function z(t){t<132||(d[t]=m,m=t)}function C(t){const e=a(t);return z(t),e}const H=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let R=new H("utf-8",{ignoreBOM:!0,fatal:!0});R.decode();let b=null;function G(){return(b===null||b.byteLength===0)&&(b=new Uint8Array(s.memory.buffer)),b}function U(t,e){return t=t>>>0,R.decode(G().subarray(t,t+e))}function c(t){m===d.length&&d.push(d.length+1);const e=m;return m=d[e],d[e]=t,e}let I=0;function J(t,e){const n=e(t.length*1,1)>>>0;return G().set(t,n/1),I=t.length,n}function f(t,e){try{return t.apply(this,e)}catch(n){s.__wbindgen_exn_store(c(n))}}class l{static __wrap(e){e=e>>>0;const n=Object.create(l.prototype);return n.__wbg_ptr=e,n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();s.__wbg_chip_free(e)}static new(){const e=s.chip_new();return l.__wrap(e)}static vram_width(){return s.chip_vram_width()>>>0}static vram_height(){return s.chip_vram_height()>>>0}vram_ptr(){return s.chip_vram_ptr(this.__wbg_ptr)}load(e){const n=J(e,s.__wbindgen_malloc),o=I;s.chip_load(this.__wbg_ptr,n,o)}next(){return s.chip_next(this.__wbg_ptr)!==0}tick(){const e=s.chip_tick(this.__wbg_ptr);return B.__wrap(e)}set_key(e){s.chip_set_key(this.__wbg_ptr,e)}unset_key(e){s.chip_unset_key(this.__wbg_ptr,e)}}class B{static __wrap(e){e=e>>>0;const n=Object.create(B.prototype);return n.__wbg_ptr=e,n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();s.__wbg_outputchange_free(e)}get vram(){return s.__wbg_get_outputchange_vram(this.__wbg_ptr)!==0}set vram(e){s.__wbg_set_outputchange_vram(this.__wbg_ptr,e)}get beep(){return s.__wbg_get_outputchange_beep(this.__wbg_ptr)!==0}set beep(e){s.__wbg_set_outputchange_beep(this.__wbg_ptr,e)}}function X(t){C(t)}function $(t){const e=a(t).crypto;return c(e)}function ee(t){const e=a(t);return typeof e=="object"&&e!==null}function te(t){const e=a(t).process;return c(e)}function ne(t){const e=a(t).versions;return c(e)}function re(t){const e=a(t).node;return c(e)}function oe(t){return typeof a(t)=="string"}function ae(){return f(function(){const t=module.require;return c(t)},arguments)}function ce(t,e){const n=U(t,e);return c(n)}function ie(t){const e=a(t).msCrypto;return c(e)}function se(){return f(function(t,e){a(t).getRandomValues(a(e))},arguments)}function _e(){return f(function(t,e){a(t).randomFillSync(C(e))},arguments)}function ue(t){return typeof a(t)=="function"}function Ae(t,e){const n=new Function(U(t,e));return c(n)}function de(){return f(function(t,e){const n=a(t).call(a(e));return c(n)},arguments)}function fe(){return f(function(){const t=self.self;return c(t)},arguments)}function ge(){return f(function(){const t=window.window;return c(t)},arguments)}function le(){return f(function(){const t=globalThis.globalThis;return c(t)},arguments)}function pe(){return f(function(){const t=global.global;return c(t)},arguments)}function we(t){return a(t)===void 0}function me(){return f(function(t,e,n){const o=a(t).call(a(e),a(n));return c(o)},arguments)}function be(t){const e=a(t).buffer;return c(e)}function he(t,e,n){const o=new Uint8Array(a(t),e>>>0,n>>>0);return c(o)}function ye(t){const e=new Uint8Array(a(t));return c(e)}function ve(t,e,n){a(t).set(a(e),n>>>0)}function xe(t){const e=new Uint8Array(t>>>0);return c(e)}function Ue(t,e,n){const o=a(t).subarray(e>>>0,n>>>0);return c(o)}function Be(t){const e=a(t);return c(e)}function Ee(t,e){throw new Error(U(t,e))}function Se(){const t=s.memory;return c(t)}URL=globalThis.URL;const _=await j({"./chip8_wasm_bg.js":{__wbindgen_object_drop_ref:X,__wbg_crypto_c48a774b022d20ac:$,__wbindgen_is_object:ee,__wbg_process_298734cf255a885d:te,__wbg_versions_e2e78e134e3e5d01:ne,__wbg_node_1cd7a5d853dbea79:re,__wbindgen_is_string:oe,__wbg_require_8f08ceecec0f4fee:ae,__wbindgen_string_new:ce,__wbg_msCrypto_bcb970640f50a1e8:ie,__wbg_getRandomValues_37fa2ca9e4e07fab:se,__wbg_randomFillSync_dc1e9a60c158336d:_e,__wbindgen_is_function:ue,__wbg_newnoargs_581967eacc0e2604:Ae,__wbg_call_cb65541d95d71282:de,__wbg_self_1ff1d729e9aae938:fe,__wbg_window_5f4faef6c12b79ec:ge,__wbg_globalThis_1d39714405582d3c:le,__wbg_global_651f05c6a0944d1c:pe,__wbindgen_is_undefined:we,__wbg_call_01734de55d61e11d:me,__wbg_buffer_085ec1f694018c4f:be,__wbg_newwithbyteoffsetandlength_6da8e527659b86aa:he,__wbg_new_8125e318e6245eed:ye,__wbg_set_5cf90238115182c3:ve,__wbg_newwithlength_e5d69174d6984cd7:xe,__wbg_subarray_13db269f57aa838d:Ue,__wbindgen_object_clone_ref:Be,__wbindgen_throw:Ee,__wbindgen_memory:Se}},q),M=_.memory,ke=_.__wbg_chip_free,Ce=_.__wbg_outputchange_free,Re=_.__wbg_get_outputchange_vram,Ge=_.__wbg_set_outputchange_vram,Ie=_.__wbg_get_outputchange_beep,Me=_.__wbg_set_outputchange_beep,Qe=_.chip_new,Te=_.chip_vram_ptr,De=_.chip_load,Le=_.chip_next,Pe=_.chip_tick,We=_.chip_set_key,Fe=_.chip_unset_key,Oe=_.chip_vram_width,Ke=_.chip_vram_height,Ne=_.__wbindgen_malloc,Ve=_.__wbindgen_exn_store,Ze=Object.freeze(Object.defineProperty({__proto__:null,__wbg_chip_free:ke,__wbg_get_outputchange_beep:Ie,__wbg_get_outputchange_vram:Re,__wbg_outputchange_free:Ce,__wbg_set_outputchange_beep:Me,__wbg_set_outputchange_vram:Ge,__wbindgen_exn_store:Ve,__wbindgen_malloc:Ne,chip_load:De,chip_new:Qe,chip_next:Le,chip_set_key:We,chip_tick:Pe,chip_unset_key:Fe,chip_vram_height:Ke,chip_vram_ptr:Te,chip_vram_width:Oe,memory:M},Symbol.toStringTag,{value:"Module"}));Y(Ze);const qe=new Float32Array([-.99,.99,0,0,-.99,-.99,0,1,.99,-.99,1,1,.99,.99,1,0]),je={attributes:[{shaderLocation:0,offset:0,format:"float32x2"},{shaderLocation:2,offset:4*2,format:"float32x2"}],arrayStride:4*4,stepMode:"vertex"},Ye=new Float32Array([1,0,0,0,1,0,0,0,1,1,1,0]),ze={attributes:[{shaderLocation:1,offset:0,format:"float32x3"}],arrayStride:4*3,stepMode:"vertex"},He=new Uint16Array([0,1,2,0,2,3]),Je=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,.19,.19,.19,1,.87,.87,.87,1]),Xe={size:{width:l.vram_width(),height:l.vram_height(),depthOrArrayLayers:1},format:"r8unorm",usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING},$e={entries:[{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}]},et={addressModeU:"repeat",addressModeV:"repeat",magFilter:"nearest",minFilter:"nearest"},E=new Map([["IBM Logo","roms/loktar00/IBM Logo.ch8"],["Brix","roms/loktar00/Brix [Andreas Gustafsson, 1990].ch8"],["Particles","roms/loktar00/Particle Demo [zeroZshadow, 2008].ch8"],["Zero","roms/loktar00/Zero Demo [zeroZshadow, 2007].ch8"],["Keypad","roms/loktar00/Keypad Test [Hap, 2006].ch8"],["Maze","roms/loktar00/Maze [David Winter, 199x].ch8"],["Trip8","roms/loktar00/Trip8 Demo (2008) [Revival Studios].ch8"],["Chip8 Pic","roms/loktar00/Chip8 Picture.ch8"],["Heart Beat","roms/mattmikolay/heartmonitor/heart_monitor.ch8"],["Morse Code","roms/mattmikolay/morsecode/morse_demo.ch8"],["Random","roms/mattmikolay/randomnumber/random_number_test.ch8"],["WipeOff","roms/aquova/WIPEOFF"],["Test Image","roms/aquova/TEST_IMG"]]),h=new Map([["1",[1,0]],["2",[2,1]],["3",[3,2]],["4",[12,3]],["q",[4,4]],["w",[5,5]],["e",[6,6]],["r",[13,7]],["a",[7,8]],["s",[8,9]],["d",[9,10]],["f",[14,11]],["z",[10,12]],["x",[0,13]],["c",[11,14]],["v",[15,15]]]),tt=new Audio("data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU="),A=document.querySelector("#chip-display")??p("No canvas element");{const e=window.devicePixelRatio??1;A.width=A.clientWidth*e,A.height=A.clientWidth/2*e,K(`canvas: ${A.width} x ${A.height}`)}const Q=navigator.gpu??p("WebGPU is not supported"),u=await(await Q.requestAdapter())?.requestDevice()??p("No device found"),T=Q.getPreferredCanvasFormat(),D=A.getContext("webgpu")??p("No webgpu context for the canvas");D.configure({device:u,format:T,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:"opaque"});const nt=u.createTexture({size:[A.width,A.height,1],dimension:"2d",format:"depth24plus-stencil8",usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC});function y(t,e){const n=u.createBuffer({size:t.byteLength+3&-4,usage:e,mappedAtCreation:!0});return(t instanceof Float32Array?new Float32Array(n.getMappedRange()):new Uint16Array(n.getMappedRange())).set(t),n.unmap(),n}const rt=y(qe,GPUBufferUsage.VERTEX),ot=y(Ye,GPUBufferUsage.VERTEX),at=y(He,GPUBufferUsage.INDEX),ct=y(Je,GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST),L=u.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{}}]}),it=u.createBindGroup({layout:L,entries:[{binding:0,resource:{buffer:ct}}]}),st=await fetch(E.get("IBM Logo")),_t=await st.arrayBuffer(),ut=new Uint8Array(_t),w=l.new();w.load(ut);const[v,P]=[l.vram_width(),l.vram_height()],At=new Uint8Array(M.buffer,w.vram_ptr(),v*P),W=u.createTexture(Xe),dt=u.createSampler(et),F=u.createBindGroupLayout($e),ft=u.createBindGroup({layout:F,entries:[{binding:1,resource:dt},{binding:2,resource:W.createView()}]}),gt=u.createRenderPipeline({layout:u.createPipelineLayout({bindGroupLayouts:[L,F]}),vertex:{module:u.createShaderModule({code:V}),entryPoint:"main",buffers:[je,ze]},fragment:{module:u.createShaderModule({code:Z}),entryPoint:"main",targets:[{format:T}]},primitive:{cullMode:"none",frontFace:"cw",topology:"triangle-list"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus-stencil8"}});async function O(t){for(;w.next();){const i=w.tick();if(i.beep&&tt.play(),i.vram)break;await N(.05)}u.queue.writeTexture({texture:W},At,{offset:0,bytesPerRow:v},{width:v,height:P});const n={view:D.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"},o=u.createCommandEncoder(),r=o.beginRenderPass({colorAttachments:[n],depthStencilAttachment:{view:nt.createView(),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store",stencilClearValue:0,stencilLoadOp:"clear",stencilStoreOp:"store"}});r.setPipeline(gt),r.setViewport(0,0,A.width,A.height,0,1),r.setScissorRect(0,0,A.width,A.height),r.setBindGroup(0,it),r.setBindGroup(1,ft),r.setVertexBuffer(0,rt),r.setVertexBuffer(1,ot),r.setIndexBuffer(at,"uint16"),r.drawIndexed(6),r.end(),u.queue.submit([o.finish()]),requestAnimationFrame(O)}const S=document.querySelectorAll("#key-og span.key")??p("No Chip8 Keys Table"),k=document.querySelectorAll("#key-map span.key")??p("No Mapped Keys Table");function lt(t){document.addEventListener("keydown",e=>{if(h.has(e.key)){const[n,o]=h.get(e.key);t.set_key(n),S[o].style.filter="invert(90%)",k[o].style.filter="invert(90%)"}}),document.addEventListener("keyup",e=>{if(h.has(e.key)){const[n,o]=h.get(e.key);t.unset_key(n),S[o].style.filter="none",k[o].style.filter="none"}})}lt(w);const x=document.querySelector("#roms")??p("No ROM selection menu");x.addEventListener("change",async t=>{const e=E.get(x.value)??"roms/loktar00/IBM Logo.ch8",n=await(await fetch(e)).arrayBuffer(),o=new Uint8Array(n);w.load(o)});for(let[t,e]of E){const n=document.createElement("option");n.value=t,n.textContent=t,x.appendChild(n)}requestAnimationFrame(O);
